<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Editor Integrated</title>

    <!-- Font link -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@200..800&display=swap" rel="stylesheet">

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Manrope', sans-serif; }
        .content { display: flex; flex-direction: row; height: 100vh; }
        #canvasContainer { flex-grow: 1; background-color: black; }
        .navbar {
            background-color: #27272C;
            color: #BABABA;
            padding: 10px;
            display: flex;
        }
        .navbar ul { list-style: none; display: flex; }
        .navbar li { position: relative; padding: 10px 15px; cursor: pointer; }
        .navbar .dropdown-content {
            display: none;
            position: absolute;
            background-color: #444;
            color: white;
            list-style: none;
            top: 100%;
            left: 0;
            width: 150px;
        }
        .navbar li:hover .dropdown-content { display: block; }
        .mode-switch {
            margin: 10px;
            display: flex;
            gap: 0;
        }
        .mode-switch button {
            padding: 10px;
            border: none;
            cursor: pointer;
            background-color: #27272C;
            color: #5F5F6B;
            font-family: 'Manrope', sans-serif;
        }
        .mode-switch button.active {
            background-color: #404046;
            color: #BABABA;
        }
        .sidebar {
            width: 20%;
            background-color: #404046;
            padding: 20px;
            color: #BABABA;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar">
        <ul>
            <li class="dropdown" id="sceneDropdown">
                Scene
                <ul class="dropdown-content" id="sceneDropdownContent">
                    <li id="addSphereOption">Add Sphere</li>
                    <li id="addCubeOption">Add Cube</li>
                    <li>
                        <input type="checkbox" id="showGrid"> 
                        <label for="showGrid">Show Grid</label>
                    </li>
                </ul>
            </li>
            <li class="dropdown" id="cameraDropdown">
                Camera
                <ul class="dropdown-content">
                    <li id="frontViewOption">Front View</li>
                    <li id="topViewOption">Top View</li>
                    <li id="resetCameraOption">Reset Camera</li>
                </ul>
            </li>
        </ul>
    </nav>

    <!-- Canvas Container -->
    <div id="canvasContainer"></div>

    <!-- Sidebar -->
    <div class="sidebar">
        <!-- Sidebar content for sliders (can be enhanced later) -->
        <h3>3D Control Panel</h3>
    </div>

    <script type="module">
        import * as THREE from "./node_modules/three/build/three.module.js";
        import { OrbitControls } from "./node_modules/three/examples/jsm/controls/OrbitControls.js";
        import { TransformControls } from "./node_modules/three/examples/jsm/controls/TransformControls.js";
        import { GLTFExporter } from "./node_modules/three/examples/jsm/exporters/GLTFExporter.js";
        import { OutlinePass } from "./node_modules/three/examples/jsm/postprocessing/OutlinePass.js";
        import { EffectComposer } from "./node_modules/three/examples/jsm/postprocessing/EffectComposer.js";
        import { RenderPass } from "./node_modules/three/examples/jsm/postprocessing/RenderPass.js";

        // Scene, Camera, Renderer Setup
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        const canvasContainer = document.getElementById('canvasContainer');
        canvasContainer.appendChild(renderer.domElement);

        const controls = new OrbitControls(camera, renderer.domElement);
        camera.position.set(0, 2, 5);
        controls.update();

        const transformControls = new TransformControls(camera, renderer.domElement);
        scene.add(transformControls);
        transformControls.addEventListener("dragging-changed", (event) => {
            controls.enabled = !event.value;
        });

        const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
        scene.add(ambientLight);
        const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
        directionalLight.position.set(5, 5, 5);
        scene.add(directionalLight);

        const gridHelper = new THREE.GridHelper(10, 10);
        scene.add(gridHelper);

        const objects = [];
        const geometry = new THREE.BoxGeometry(1, 1, 1);
        const sphereGeometry = new THREE.SphereGeometry(0.5, 32, 32);

        const params = {
            addCube: () => {
                const cube = new THREE.Mesh(geometry, new THREE.MeshStandardMaterial({ color: Math.random() * 0xffffff }));
                cube.position.set(Math.random() * 4 - 2, 0.5, Math.random() * 4 - 2);
                scene.add(cube);
                objects.push(cube);
            },
            addSphere: () => {
                const sphere = new THREE.Mesh(sphereGeometry, new THREE.MeshStandardMaterial({ color: Math.random() * 0xffffff }));
                sphere.position.set(Math.random() * 4 - 2, 0.5, Math.random() * 4 - 2);
                scene.add(sphere);
                objects.push(sphere);
            },
            gridVisible: true,
            toggleGrid: () => {
                gridHelper.visible = params.gridVisible;
            },
            topView: () => {
                camera.position.set(0, 5, 0);
                camera.lookAt(0, 0, 0);
                controls.update();
            },
            frontView: () => {
                camera.position.set(0, 2, 5);
                camera.lookAt(0, 0, 0);
                controls.update();
            },
            resetCamera: () => {
                camera.position.set(0, 2, 5);
                camera.lookAt(0, 0, 0);
                controls.update();
            }
        };

        // Event Listeners for Navbar
        document.getElementById('addSphereOption').addEventListener('click', params.addSphere);
        document.getElementById('addCubeOption').addEventListener('click', params.addCube);
        document.getElementById('showGrid').addEventListener('change', (event) => {
            params.gridVisible = event.target.checked;
            params.toggleGrid();
        });
        document.getElementById('frontViewOption').addEventListener('click', params.frontView);
        document.getElementById('topViewOption').addEventListener('click', params.topView);
        document.getElementById('resetCameraOption').addEventListener('click', params.resetCamera);

        window.addEventListener('resize', () => {
            camera.aspect = canvasContainer.clientWidth / canvasContainer.clientHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(canvasContainer.clientWidth, canvasContainer.clientHeight);
        });

        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            renderer.render(scene, camera);
        }
        animate();
    </script>
</body>
</html>
